<div class="sidebar-blur" *ngIf="isCategory">
  <app-category [slug]="categorySlug" [type]="brandSlug"></app-category>
</div>
<div class="sidebar-blur" *ngIf="isInfoPage">
  <div class="tabs primary-bg">
    <div class="container position-relative">
      <div
        class="prev position-absolute top-50 start-0 translate-middle-y ps-4"
        [ngClass]="
          categories.length > this.commonService.brandInfoTabs ? '' : 'd-none'
        "
        (click)="prev()"
      >
        <img
          data-src="{{ s3Url }}left-arrow.svg"
          loading="lazy"
          class="lazyload"
        />
      </div>
      <ul class="row m-0 px-5 row-cols-lg-6 row-cols-md-3 row-cols-sm-1">
        <li
          *ngFor="let item of categories; index as i"
          class="border-end text-center p-0"
          [ngClass]="
            i < commonService.brandInfoTabs + skipTab && i >= skipTab
              ? 'active'
              : 'd-none'
          "
        >
          <span
            class="
              d-inline-flex
              justify-content-around
              align-items-center
              mx-auto
              position-relative
            "
            [ngClass]="i + 1 === activeTab ? 'active' : ''"
            (click)="setActiveTab(i + 1, item)"
            >{{ item?.name }}</span
          >
        </li>
      </ul>
      <div
        class="next position-absolute top-50 end-0 translate-middle-y pe-4"
        [ngClass]="
          categories.length > this.commonService.brandInfoTabs ? '' : 'd-none'
        "
        (click)="next()"
      >
        <img
          data-src="{{ s3Url }}right-arrow.svg"
          loading="lazy"
          class="lazyload"
        />
      </div>
    </div>
  </div>
  <!-- Tabs end -->
  <ng-container *ngIf="isStory">
    <div class="strory-banner--img container customContainer">
      <a
        href="#"
        onclick="return false;"
        class="d-block video-btn"
        data-bs-toggle="modal"
        data-bs-target="#brandInfoModal"
        (click)="openVideoPlayer = true"
      >
        <img
          appYoutubeImage
          class="lazyload"
          width="888"
          height="506"
          data-src="{{ brandInfo.media | defaultImage: 888:506 }}"
          alt="brand_img"
          loading="lazy"
        />
        <img
          *ngIf="brandInfo.media.type === 'video'"
          data-src="{{ s3Url }}videoIcon.png"
          alt="Play"
          class="img-fluid vide-play lazyload"
          loading="lazy"
        />
      </a>
    </div>
  </ng-container>
  <!-- story tab banner -->
  <div
    class="container customContainer brand-page-row--wrapper"
    [ngClass]="isMarket ? 'mb-4 available-marketing--wrapper' : ''"
    [class.info-wrapper]="isStory"
  >
    <div class="row d-flex">
      <div
        class="col-md-12 pl-0 brand-left-info--wrapper"
        [ngClass]="!isInfo ? 'col-lg-12' : 'col-lg-8'"
      >
        <div class="brand-main-img--wrapper" *ngIf="isInfo">
          <a
            href="#"
            onclick="return false;"
            class="d-block video-btn"
            data-bs-toggle="modal"
            data-bs-target="#brandInfoModal"
            (click)="openVideoPlayer = true"
          >
            <img
              appYoutubeImage
              class="lazyload"
              width="888"
              height="506"
              data-src="{{ brandInfo.media | defaultImage: 888:506 }}"
              alt="brand_img"
              loading="lazy"
            />
            <img
              *ngIf="brandInfo.media && brandInfo.media.type === 'video'"
              data-src="{{ s3Url }}videoIcon.png"
              alt="Play"
              class="img-fluid vide-play lazyload"
              loading="lazy"
            />
          </a>
        </div>
        <div class="main-desc-bottom--wrapper">
          <h2 class="title-highlighter text-uppercase" *ngIf="isInfo">
            {{ brandInfo?.name }} INFO
          </h2>
          <div
            class="question-container container customContainer"
            *ngIf="isInfo"
          >
            <div
              class="question-section"
              *ngFor="let item of items; let i = index"
            >
              <div class="header header-highlighter align-items-center">
                <h3 class="col-md-12 title mb-0">
                  {{ item?.title }}
                </h3>
              </div>
              <div class="description pt-4 px-3">
                <a
                  *ngIf="item?.media && item?.media?.type === 'image'"
                  href="#"
                  onclick="return false;"
                  class="d-block"
                >
                  <figure>
                    <img
                      appYoutubeImage
                      data-src="{{ item?.media | defaultImage: 796:0 }}"
                      width="100%"
                      height="0"
                      alt="info-image"
                      class="lazyload"
                    />
                  </figure>
                </a>
                <div
                  *ngIf="item?.media && item?.media?.type === 'video'"
                  class="d-block video-btn"
                >
                  <iframe
                    [src]="item?.media?.url | safeUrl"
                    style="max-width: 100%; height: 400"
                    height="400"
                    width="100%"
                    scrolling="no"
                    frameborder="0"
                    webkitallowfullscreen
                    mozallowfullscreen
                    allowfullscreen
                  ></iframe>
                </div>
                <p
                  class="descriptionDetails"
                  *ngIf="item?.short_description"
                  [innerHTML]="item?.short_description"
                ></p>
              </div>
            </div>
          </div>

          <div *ngIf="isPdf">
            <div
              class="
                container
                customContainer
                py-md-5 py-3
                pl-5
                ml-5
                download-pdf--wrapper
              "
            >
              <div class="frannews-left--wrapper">
                <div class="frannews-top-left large-main-article d-flex text-capitalize">Learn More About</div>
                <img
                  class="lazyload"
                  width="298"
                  height="112"
                  data-src="{{ logo }}"
                  alt="brand_logo"
                  loading="lazy"
                />
                <div class="pt-3">
                  <button
                    *ngIf="items?.email_popup"
                    data-bs-toggle="modal"
                    data-bs-target="#pdfModal"
                    type="submit"
                    class="
                      text-center
                      submit-btn
                      text-white
                      rounded-0
                      btn-sm
                    "
                  >
                    Download PDF
                  </button>
                  <a
                    *ngIf="!items?.email_popup"
                    href="{{ changeDownPDFUrl(items?.media?.url) }}"
                    target="_blank"
                  >
                    <button
                      type="submit"
                      class="
                        text-center
                        submit-btn
                        text-white
                        rounded-0
                        btn-sm
                      "
                    >
                      Download PDF
                    </button>
                  </a>
                </div>
              </div>
              <div class="frannews-right--wrapper" *ngIf="items.image">
                <div class="frannews-image--wrapper">
                  <img
                    appYoutubeImage
                    data-src="{{ items?.image | defaultImage: 417:353 }}"
                    class="lazyload"
                    width="417"
                    height="353"
                    alt="pdf"
                  />
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="isStory && items">
            <div class="container customContainer mt-4 py-3">
                <app-article [typeSlug]="tab" [contents]="items" [class]="'row-cols-lg-5'"></app-article>
            </div>
          </div>

          <div class="container customContainer whyIBought" *ngIf="isBought">
            <div>
              <ul class="d-flex">
                <li class="header-title">
                  <h2 class="text-uppercase sectionTitle mb-0">
                    {{ items?.name }}
                  </h2>
                </li>
                <li>
                  <h2 class="text-uppercase sectionTitle mb-0">WHY I BOUGHT</h2>
                </li>
              </ul>
            </div>
            <p class="descriptionDetails" *ngIf="items?.content" [innerHTML]="items?.content"></p>
          </div>

          <div class="container customContainer whyIBought" *ngIf="isExecutive">
            <div>
              <ul class="d-flex">
                <li class="header-title">
                  <h2 class="text-uppercase sectionTitle mb-0">
                    {{ items?.name }}
                  </h2>
                </li>
                <li>
                  <h2 class="text-uppercase sectionTitle mb-0">EXECUTIVE Q&A</h2>
                </li>
              </ul>
            </div>
            <p class="descriptionDetails" *ngIf="items?.content" [innerHTML]="items?.content"></p>
          </div>

          <div class="container whyIBought d-flex" *ngIf="isMarket">
            <ul>
              <li class="marketHeading">
                <h2 class="text-uppercase sectionTitle mb-0">Available Markets</h2>
              </li>
            </ul>
          </div>
          <div>
            <div
              *ngIf="
                isMarket &&
                items['available-markets'] != null &&
                items['available-markets'].length
              "
              class="mapcontainer mt-5"
            >
              <div class="lg-map-wrapper" style="width: 100%; height: auto">
                <svg id="map" width="800" height="500"></svg>
              </div>
            </div>
            <div class="market-map-legend">
              <div
                *ngIf="
                  isMarket &&
                  items['available-markets'] != null &&
                  items['available-markets'].length
                "
                class="map-legend"
              >
                MAP LEGEND:
                <div class="row items">
                  <div class="col-xl-8 col-md-12">
                    <div class="row m-0">
                      <div
                        *ngFor="let market of items['available-markets']"
                        class="col-sm-5 map-legend-item"
                      >
                        <div class="market-names">
                          <div class="">
                            <div
                              class="market-status-color"
                              [style.backgroundColor]="market.color"
                            ></div>
                          </div>
                          <div class="align-self-center lh-base">
                            <span class="text-uppercase market-name">{{
                              market.name
                            }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  *ngIf="
                    isMarket &&
                    items['international-markets'] != null &&
                    items['international-markets'].length
                  "
                  class="mt-2"
                >
                  <h3 class="map-legend-internatioal">
                    INTERNATIONAL MARKETS:
                  </h3>
                  <div class="row ms-1 items">
                    <div
                      class="col-sm-3 map-legend-item"
                      *ngFor="let market of items['international-markets']"
                    >
                      <div class="row market-names">
                        <div class="col-xs-10">
                          <span class="text-uppercase market-name">{{
                            market.name
                          }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        class="col-lg-4 col-md-12 pr-0 pl-0"
        *ngIf="isInfo || isMarket"
        [ngClass]="isMarket ? 'market-rightsiderbar' : ''"
      >
        <div class="financial-requirement-section more-brand--wrapper">
          <div class="header" *ngIf="isInfo">
            <h1 class="title text-uppercase">Financial Requirements</h1>
          </div>
          <div class="headerMarket" *ngIf="isMarket">
            <h2 class="titleMarket">More Brand Info</h2>
          </div>
          <div class="financial-description" *ngIf="isInfo">
            <p class="text">
              {{ brandInfo?.more_info }}
            </p>
            <p class="text">
              Initial Franchise Fee:
              <span class="highlight-text">
                {{ brandInfo?.franchise_fee }}
              </span>
            </p>
            <p class="text">
              Initial Investment Range:
              <span class="highlight-text">
                {{ brandInfo?.startup_costs }}
              </span>
            </p>
            <p class="text">Minimum Qualifications:</p>
            <p
              class="highlight-text min-qualification"
              *ngFor="let info of brandInfo?.optional_info"
            >
              {{ info.title }} {{ info.value }} <br />
            </p>
            <p class="text">
              Territory: Protected territory with geographic rights to the
              Sylvan system in a well-defined area
            </p>
            <p class="text">
              With an average gross revenue of $518,159 among the top 25% of
              territories, Sylvan Learning offers a business opportunity with
              both financial and emotional rewards.
            </p>
            <p class="text" *ngFor="let info of brandInfo?.optional_info">
              {{ info.title }} :
              <span class="highlight-text">{{ info.value }}</span>
            </p>
          </div>

          <div class="market" *ngIf="isMarket">
            <p class="text">
              {{ brandInfo?.more_info }}
            </p>
            <p class="text">
              Initial Franchise Fee:
              <span class="highlight-text">
                {{ brandInfo?.franchise_fee }}
              </span>
            </p>
            <p class="text">
              Initial Investment Range:
              <span class="highlight-text">
                {{ brandInfo?.startup_costs }}
              </span>
            </p>
            <p class="text">Minimum Qualifications:</p>
            <p
              class="highlight-text min-qualification"
              *ngFor="let info of brandInfo?.optional_info"
            >
              {{ info.title }} {{ info.value }} <br />
            </p>
            <p class="text">
              Territory: Protected territory with geographic rights to the
              Sylvan system in a well-defined area
            </p>
            <p class="text">
              With an average gross revenue of $518,159 among the top 25% of
              territories, Sylvan Learning offers a business opportunity with
              both financial and emotional rewards.
            </p>
            <p class="text" *ngFor="let info of brandInfo?.optional_info">
              {{ info.title }} :
              <span class="highlight-text">{{ info.value }}</span>
            </p>
          </div>
        </div>

        <div class="inquiry-form-section">
          <div class="header py-2" *ngIf="!isMarket">
            <h1 class="title">INQUIRE NOW</h1>
          </div>
          <div class="header" *ngIf="isMarket">
            <h1 class="market-header text-uppercase">Inquire about services</h1>
          </div>
          <form
            *ngIf="inquireForm"
            [formGroup]="inquireForm"
            (ngSubmit)="submitInquireForm(inquireForm.value)"
          >
            <div class="row" *ngFor="let fields of inquireFields">
              <div class="col-12 inquirefrom-row">
                <input
                  [ngClass]="
                    (formControlsValues[fields.key].touched ||
                      submittedInquireForm) &&
                    (formControlsValues[fields.key].errors?.required ||
                      formControlsValues[fields.key].errors?.email ||
                      formControlsValues[fields.key].errors?.pattern)
                      ? 'isError'
                      : ''
                  "
                  *ngIf="fields.type === 'text'"
                  [formControlName]="fields.key"
                  placeholder="{{ fields.title }}*"
                  [id]="fields.key"
                  class="form-control"
                  [type]="fields.type"
                  [pattern]="fields.pattern"
                  [maxLength]="fields.maxLength || 1000"
                />

                <textarea
                  *ngIf="fields.type === 'textarea'"
                  [placeholder]="fields.title"
                  [formControlName]="fields.key"
                  [id]="fields.key"
                  class="form-control"
                  rows="3"
                  [ngClass]="{
                    'is-invalid':
                      (formControlsValues[fields.key].touched ||
                        submittedInquireForm) &&
                      formControlsValues[fields.key].errors?.required
                  }"
                ></textarea>

                <select
                  required
                  *ngIf="fields.type === 'dropdown'"
                  [formControlName]="fields.key"
                  [id]="fields.key"
                  class="form-select"
                  [ngClass]="{
                    'is-invalid':
                      (formControlsValues[fields.key].touched ||
                        submittedInquireForm) &&
                      formControlsValues[fields.key].errors?.required
                  }"
                >
                  <option value="" disabled selected hidden>
                    {{ fields.title }}*
                  </option>
                  <option *ngFor="let value of fields.enum" value="{{ value }}">
                    <span>{{ value }}</span>
                  </option>
                </select>
                <div
                  class="invalid-feedback d-block"
                  *ngIf="
                    (formControlsValues[fields.key].touched ||
                      submittedInquireForm) &&
                    (formControlsValues[fields.key].errors?.required ||
                      formControlsValues[fields.key].errors?.email ||
                      formControlsValues[fields.key].errors?.pattern)
                  "
                >
                  {{ fields.errorMsg }}
                </div>
              </div>
            </div>
            <div class="divider-recent-feature row">
              <button type="submit" class="btn text-white rounded-0 w-100 h-50">
                Next
              </button>
            </div>
            <br />
            <span *ngIf="isSubmitted && isSubmitFailed" class="errS">{{
              submitErrMsg
            }}</span>
          </form>

          <!-- Recent Features -->
          <div class="recent-feature-article-section" *ngIf="!isMarket">
            <div class="row">
              <div class="col-md-12">
                <div class="title-tag">RECENT FEATURES</div>
                <div
                  class="recent-item"
                  *ngFor="let item of featured | slice: 0:3"
                >
                  <a
                    routerLink="/{{ commonService.readMore(item) }}"
                    fragment="featured"
                  >
                    <p class="title">{{ item.title }}</p>
                    <p class="description">{{ item.short_description }}</p>
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- Featured Article Section -->
          <div class="divider-main" *ngIf="!isMarket"></div>
          <div class="feature-article-section" *ngIf="!isMarket">
            <div class="row d-flex align-items-center justify-content-center">
              <div class="col-md-9">
                <div
                  class="feature-item"
                  *ngFor="let item of featured | slice: 3:6"
                >
                  <div class="image-tag">FEATURED ARTICLE</div>
                  <a
                    routerLink="/{{ commonService.readMore(item) }}"
                    fragment="featured"
                  >
                    <img
                      appYoutubeImage
                      data-src="{{ item?.media | defaultImage: 281:175 }}"
                      data-srcset="{{
                        item.media | defaultImage: 260:145
                      }} 545w, 
                      {{ item.media | defaultImage: 355:240 }} 355w, 
                      {{ item.media | defaultImage: 300:210 }} 300w,
                      {{ item.media | defaultImage: 281:175 }} 281w"
                      data-sizes="{{
                        '(max-width: 576px) 545px,
                      (max-width: 768px) 355px,
                      (max-width: 992px) 300px,
                      (max-width: 1200px) 281px,
                      281px'
                      }}"
                      width="281"
                      height="260"
                      alt="featured"
                      class="lazyload"
                      loading="lazy"
                    />
                    <div class="image-description">
                      {{ item?.title }}
                    </div>
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- Trending Secion -->
          <div class="divider-main" *ngIf="trending.length && !isMarket"></div>
          <div class="trending-section" *ngIf="trending.length && !isMarket">
            <div class="title-tag ml-1">TRENDING</div>

            <div class="row trending-item" *ngFor="let item of trending">
              <div class="col-5">
                <a
                  routerLink="/{{ commonService.readMore(item) }}"
                  fragment="trending"
                >
                  <img
                    appYoutubeImage
                    data-src="{{ item?.media | defaultImage: 139:74 }}"
                    width="139"
                    height="74"
                    alt="trending"
                    class="image-area lazyload"
                    loading="lazy"
                /></a>
              </div>

              <div class="col image-description">
                <a
                  routerLink="/{{ commonService.readMore(item) }}"
                  fragment="trending"
                  >{{ item?.title }}
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="isBrowser" class="search_pop_up modal" id="pdfModal">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="sponsored-modal-content">
              <button
                type="button"
                class="close text-right"
                data-bs-dismiss="modal"
              >
                &times;
              </button>
              <h2 class="text-uppercase">Download PDF</h2>
              <div class="email-content">
                <form
                  [formGroup]="pdfForm"
                  (ngSubmit)="emailSubscribe(pdfForm)"
                >
                  <div class="form-group">
                    <label>Enter Email:</label>
                    <input
                      type="text"
                      [formControl]="pdfForm.controls['emailInput']"
                      class="form-control"
                    />
                    <app-error-message
                      *ngIf="isEmailSubmit"
                      class="full-width"
                      [control]="pdfForm.controls['emailInput']"
                    ></app-error-message>
                    <p *ngIf="emailSubValid" class="invalid">
                      {{ emailSubMessage }}
                    </p>
                    <button
                      type="button"
                      id="pdf-btn"
                      (click)="emailSubscribe(pdfForm)"
                    >
                      Download
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- modal -->
<div
  *ngIf="brandInfo.media && brandInfo.media.type === 'video'"
  class="modal fade"
  id="brandInfoModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-body">
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="openVideoPlayer = false"
        ></button>
        <iframe
          *ngIf="openVideoPlayer"
          [src]="brandVideoUrl | safeUrl"
          frameborder="0"
          width="100%"
          height="496px"
          allowfullscreen
        >
        </iframe>
      </div>
    </div>
  </div>
</div>
